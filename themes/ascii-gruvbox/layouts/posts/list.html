{{ define "main" }}
<div class="content-wrapper">
  <div class="main-content">
    <div class="main-header">
      <h1>{{ .Title }}</h1>
    </div>

    <div id="post-list">
      {{ range (.Paginator.Pages.GroupByDate "2006") }}
      <section class="year-section">
        <h2 class="year-header">{{ .Key }}</h2>
        <ul class="post-list">
          {{ range .Pages }}
          <li class="post-item" data-tags="{{ delimit .Params.tags `,` }}">
            <h3 class="post-title">
              <a href="{{ .Permalink }}">{{ .Title }}</a>
            </h3>
            <div class="post-meta">
              <span>{{ .Date.Format "January 02" }}</span>
              {{ if .Params.tags }}
              <span> | Tags: 
                {{ range .Params.tags }}
                  <a href="{{ `/tags/` | relURL }}{{ . | urlize }}" class="tag">{{ . }}</a>
                {{ end }}
              </span>
              {{ end }}
            </div>
            <p>{{ .Summary }}</p>
          </li>
          {{ end }}
        </ul>
      </section>
      {{ end }}
    </div>

    {{ template "_internal/pagination.html" . }}
  </div>
  
  <aside class="sidebar">
    <div class="sidebar-header">
      <h3>filter</h3>
    </div>
    <section class="tag-section">
      <input type="text" id="tag-search" placeholder="search by tag" />
    </section>
    
    <section class="tag-section">
      <h3>tags</h3>
      <div class="tag-cloud">
        {{ range $name, $taxonomy := .Site.Taxonomies.tags }}
          <a href="{{ `/tags/` | relURL }}{{ $name | urlize }}" class="tag">
            {{ $name }} ({{ $taxonomy.Count }})
          </a>
        {{ end }}
      </div>
    </section>
  </aside>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const searchInput = document.getElementById('tag-search');
  const postList = document.getElementById('post-list');
  const posts = postList.querySelectorAll('.post-item');

  searchInput.addEventListener('input', function() {
    const searchTerm = this.value.toLowerCase();
    
    posts.forEach(function(post) {
      const tags = post.getAttribute('data-tags').toLowerCase();
      
      if (searchTerm === '' || tags.includes(searchTerm)) {
        post.style.display = 'block';
      } else {
        post.style.display = 'none';
      }
    });
  });
});
</script>
{{ end }}